<div class="table" *ngIf="canReadContracts">
  <!-- Table header -->
  <div class="table-header">
    <div class="table-title">{{ "existing-contract" | translate }}</div>
    <div class="table-search">
      <img src="/assets/icons/search-icon.svg" alt="" />
      <input
        type="text"
        [placeholder]="'Search by applicant\'s mobile number' | translate"
        [(ngModel)]="searchTerm"
        (input)="onSearch()"
      />
    </div>
  </div>
  <!-- Table titles -->
  <div class="table-titles">
    <div>
      <span>{{ "Tenant" | translate }}</span>
      <span>
        <img
          src="/assets/icons/sort-img.svg"
          alt=""
          (click)="sortBy('tenantName')"
        />
      </span>
    </div>
    <div>
      <span>{{ "TenantContactNo" | translate }}</span>
      <span>
        <img
          src="/assets/icons/sort-img.svg"
          alt=""
          (click)="sortBy('tenantMobile')"
        />
      </span>
    </div>

    <div>
      <span>{{ "Owner" | translate }}</span>
      <span>
        <img
          src="/assets/icons/sort-img.svg"
          alt=""
          (click)="sortBy('ownerName')"
        />
      </span>
    </div>

    <div>
      <span>{{ "ContactNo" | translate }}</span>
      <span>
        <img
          src="/assets/icons/sort-img.svg"
          alt=""
          (click)="sortBy('ownerMobile')"
        />
      </span>
    </div>
    <div>
      <span>{{ "propertytype" | translate }}</span>
      <span>
        <img
          src="/assets/icons/sort-img.svg"
          alt=""
          (click)="sortBy('propertyType')"
        />
      </span>
    </div>
    <div>
      <span>{{ "Location" | translate }}</span>
      <span>
        <img
          src="/assets/icons/sort-img.svg"
          alt=""
          (click)="sortBy('location')"
        />
      </span>
    </div>
    <div>
      <span>{{ "Annual Rent" | translate }}</span>
      <span>
        <img
          src="/assets/icons/sort-img.svg"
          alt=""
          (click)="sortBy('annualRent')"
        />
      </span>
    </div>
    <div>
      <span>{{ "Monthly Rent Amount" | translate }}</span>
      <span>
        <img
          src="/assets/icons/sort-img.svg"
          alt=""
          (click)="sortBy('monthlyRentAmount')"
        />
      </span>
    </div>
    <div>
      <span>{{ "startDate" | translate }}</span>
      <span>
        <img
          src="/assets/icons/sort-img.svg"
          alt=""
          (click)="sortBy('startDate')"
        />
      </span>
    </div>

    <div>
      <span>{{ "Endofcontract" | translate }}</span>
      <span>
        <img
          src="/assets/icons/sort-img.svg"
          alt=""
          (click)="sortBy('endOfContract')"
        />
      </span>
    </div>
    <div>
      <span>{{ "Actions" | translate }}</span>
    </div>
  </div>

  <!-- Loading state -->
  <div *ngIf="isLoading" class="loading">
    {{ "Loading..." | translate }}
  </div>

  <!-- No data -->
  <div *ngIf="!isLoading && filteredItems.length === 0" class="table-no-data">
    {{ "No data found" | translate }}
  </div>

  <!-- Table rows -->
  <ng-container *ngIf="!isLoading">
    <div class="table-row" *ngFor="let item of paginatedItems">
      <div>{{ item.tenantName }}</div>
      <div>
        <span dir="ltr" class="p-0">
          {{ item.tenantMobile }}
        </span>
      </div>
      <div>{{ item.ownerName }}</div>
      <div>{{ item.ownerMobile }}</div>
      <div>{{ item.propertyType }}</div>
      <div>{{ item.location }}</div>
      <div>
        <div class="turncated-text" title="{{ item.annualRent }}">
          {{
            item.annualRent !== "-"
              ? item.annualRent + " " + ("SAR" | translate)
              : item.annualRent
          }}
        </div>
      </div>
      <div>
        <div class="turncated-text" title="{{ item.monthlyRentAmount }}">
          {{
            item.monthlyRentAmount !== "-"
              ? item.monthlyRentAmount + " " + ("SAR" | translate)
              : item.monthlyRentAmount
          }}
        </div>
      </div>

      <div>{{ item.startDate }}</div>
      <div>{{ item.endOfContract }}</div>
      <div class="table-actions">
        <span
          class="action-icon info-icon"
          (click)="viewRentalApplication(item.rent_request_id)"
          [title]="'View Rental Application Details' | translate"
        >
          <img src="/assets/icons/eye-icon.svg" alt="View details" />
        </span>
      </div>
    </div>
  </ng-container>

  <!-- Table pagination -->
  <div class="table-pagination" *ngIf="!isLoading && filteredItems.length > 0">
    <div></div>

    <div class="table-pagination--pages">
      <div class="table-pagination--pages--count">
        {{ paginationStart + 1 }}-{{ paginationEnd }}
        {{ "of" | translate }}
        {{ apiTotal }}
      </div>

      <div class="table-pagination--pages--buttons" dir="ltr">
        <button (click)="prevPage()" [disabled]="currentPage === 1">
          <img src="/assets/icons/arrow-left.svg" alt="prev icon" />
        </button>
        <span
          *ngFor="let page of totalPagesArray"
          (click)="goToPage(page)"
          [class.active]="page === currentPage"
          >{{ page }}</span
        >
        <button (click)="nextPage()" [disabled]="currentPage === totalPages">
          <img src="/assets/icons/arrow-right.svg" alt=" next icon " />
        </button>
      </div>
    </div>
  </div>
</div>

<!-- No access message -->
<div *ngIf="!isLoading && !canReadContracts" class="no-access-message">
  {{ "You don't have permission to view existing contracts" | translate }}
</div>
